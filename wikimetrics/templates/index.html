{% extends "layout.html" %}
{% block body %}
{% if error %}<p class="text-warning"><strong>Warning:</strong> {{ error }}</p>{% endif %}

<div class="hero-unit">
    <h1>Wiki Metrics</h1>
    <p class="margin-top:2em">
        Welcome to the Wikimedia Foundation's Wikimetrics homepage.
        This API allows you to select a set of users, also known as a "cohort"
        <span class="muted">
            (for example, <a href="{{url_for('cohort_detail', name_or_id='e3_donor_referral_thank_you_b')}}">all users who signed up via the Thank You campaign</a>)
        </span>,
        select a metric to be computed for each of these users
        <span class="muted">
            (for example, their <a href="{{ url_for('metrics_index') + '#RevertRate'}}">revert rate</a>)
        </span>
        with optional parameters
        <span class="muted">
            (for example, a <strong>time range</strong>)
        </span>
        and retrieve the response in JSON or CSV format.
        </p>
        <p>
        You can also compute a single, aggregate value for the cohort
        <span class="muted">
            (like the <strong>mean</strong> revert rate)
        </span>
        .
    </p>
    <p class="margin-top:1em">
        <a class="btn btn-large" href="/about/">Learn More</a>
        <a class="btn btn-primary btn-large" href="{{url_for('jobs_request')}}">Analyze</a>
    </p>
</div>

<div class="row-fluid">
    {% if current_user.is_authenticated() %}
    <div class="span4">
        <h4>Your <a href="{{url_for('cohorts_index')}}">cohorts</a></h4>
        <ul data-bind="foreach: cohorts">
            <li>
                <span data-bind="text: name"></span>
            </li>
        </ul>
    </div>
    <div class="span4">
        <h4>List of <a href="{{url_for('metrics_index')}}">metrics</a></h4>
        <ul data-bind="foreach: metrics">
            <li>
                <span data-bind="text: label"></span>
            </li>
        </ul>
    </div>
    <div class="span4">
        <h4>Your <a href="{{url_for('jobs_index')}}">jobs</a></h4>
        <ul data-bind="foreach: jobs">
            <li>
                <span data-bind="text: moment(created).format('YYYY-MM-DD HH:mm')"></span> - 
                <span data-bind="text: name"></span>
            </li>
        </ul>
    </div>
    {% else %}
    <div>
        <h4><a href="{{url_for('login')}}">Login</a> to see your cohorts, metrics, and jobs</h4>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endblock %}
